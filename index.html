<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#1a1a2e">
    <title>MusiChris App</title>
    
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/MusiChris-App/style.css"> 
</head>
<body>

    <div id="customToast"></div>
    <audio id="audioElement" preload="auto" crossorigin="anonymous" playsinline></audio>

    <div id="view-login" class="view-section active"> 
      <div class="bg-bubble b1"></div><div class="bg-bubble b2"></div><div class="bg-bubble b3"></div>
      <div class="login-card">
        <div class="logo-text">Musi<span>Chris üéµ</span></div>
        <p id="loginSubtext" style="margin-bottom:20px;opacity:0.8;color:white">Bienvenido</p>
        <div id="loginFormContainer">
            <input type="text" id="loginEmail" class="login-input" placeholder="Usuario">
            <div class="password-wrapper">
                <input type="password" id="loginPass" class="login-input" placeholder="Contrase√±a">
                <span class="material-icons-round pass-toggle" id="btnTogglePass">visibility_off</span>
            </div>
        </div>
        <button class="btn-login" id="btnLoginBtn">Ingresar</button>
      </div>
    </div>

    <div id="view-admin" class="view-section">
      <div class="container">
        <header>
          <div class="brand">Musi<span>Chris</span> Admin</div>
          <div class="header-right">
             <button class="btn-icon" onclick="openModal('dom_modal_announcement')"><span class="material-icons-round">campaign</span></button>
             <button class="btn-icon" onclick="openModal('dom_modal_settings')"><span class="material-icons-round">settings</span></button>
             <div class="user-profile" onclick="openProfile()">
                 <img src="" class="avatar" id="adminAvatar">
                 <span id="adminNameDisplay">Admin</span>
             </div>
             <button class="btn-icon btn-logout" onclick="app_logout()"><span class="material-icons-round">logout</span></button>
          </div>
        </header>
        
        <div class="stats-grid">
          <div class="card">
              <div style="display:flex; justify-content:space-between; align-items:center; width:100%">
                  <h3>Canciones</h3>
                  <span class="material-icons-round" onclick="openModal('dom_modal_date_filter')" style="cursor:pointer;color:var(--accent)">calendar_today</span>
              </div>
              <div class="value" id="statsTotalSongs">0</div>
              <div id="filterStatus" style="display:none;font-size:0.7rem;color:#f1c40f;margin-top:2px">üìÖ Filtro Activo</div>
          </div>
          <div class="card"><h3>Usuarios</h3><div class="value" id="statsTotalUsers">0</div></div>
          <div class="card"><h3>Nube</h3><div class="value" id="storageText" style="font-size:1.2rem;color:#00b894">0%</div><div style="width:100%;height:4px;background:#333;margin-top:5px"><div id="storageBar" style="width:0%;height:100%;background:#00d4ff"></div></div></div>
        </div>

        <div class="tabs">
          <button class="tab-btn active" onclick="switchTab('admin-music', this)">M√∫sica</button>
          <button class="tab-btn" onclick="switchTab('admin-playlists', this)">Playlist</button>
          <button class="tab-btn" onclick="switchTab('admin-albums', this)">√Ålbum</button>
          <button class="tab-btn" onclick="switchTab('admin-users', this)">Usuarios</button>
        </div>
        
        <div id="admin-music" class="list-tab-content active">
            <button class="btn-submit" onclick="openUpload()" style="margin-bottom:15px;background:var(--success)">+ Subir Canci√≥n</button>
            <input type="text" id="searchInputAdmin" class="form-input" placeholder="üîç Buscar..." onkeyup="renderMusic('adminSongList', true)">
            <div id="adminSongList"></div>
        </div>
        <div id="admin-playlists" class="list-tab-content"><button class="btn-submit" onclick="openModal('dom_modal_playlist')" style="margin-bottom:10px">+ Lista</button><div id="adminPlaylistGrid" class="playlist-grid"></div></div>
        <div id="admin-albums" class="list-tab-content"><button class="btn-submit" onclick="openModal('dom_modal_album')" style="margin-bottom:10px">+ √Ålbum</button><div id="adminAlbumGrid" class="playlist-grid"></div></div>
        <div id="admin-users" class="list-tab-content"><button class="btn-submit" onclick="openModal('dom_modal_user')" style="margin-bottom:10px">+ Usuario</button><div id="usersListGrid"></div></div>
      </div>
    </div>

    <div id="view-user" class="view-section">
      <div class="container">
        <header>
          <div class="brand">Musi<span>Chris</span></div>
          <div class="header-right"><div class="user-profile" onclick="openProfile()"><img src="" class="avatar" id="userAvatarImg"><span id="userGreeting">Hola</span></div><button class="btn-icon btn-logout" onclick="app_logout()"><span class="material-icons-round">logout</span></button></div>
        </header>
        <div id="guestNotice" style="display:none;background:var(--accent);color:black;padding:10px;border-radius:10px;margin-bottom:15px;text-align:center;font-weight:bold">üéµ Modo Invitado: Solo puedes escuchar esta canci√≥n.</div>
        <div id="userAnnouncement" style="display:none;background:rgba(0,212,255,0.15);padding:10px;border-radius:10px;margin-bottom:15px"><p id="announcementText" style="margin:0"></p></div>
        
        <div class="tabs" id="userTabs">
          <button class="tab-btn active" onclick="switchTab('user-music', this)">M√∫sica</button>
          <button class="tab-btn" onclick="switchTab('user-albums', this)">√Ålbumes</button>
          <button class="tab-btn" onclick="switchTab('user-playlists', this)">Playlist</button>
        </div>
        <div id="user-music" class="list-tab-content active">
            <input type="text" id="searchInput" class="form-input" placeholder="üîç Buscar..." onkeyup="renderUserMusic()">
            <div id="userSongList"></div>
        </div>
        <div id="user-albums" class="list-tab-content"><div id="userAlbumGrid" class="playlist-grid"></div></div>
        <div id="user-playlists" class="list-tab-content"><button class="btn-submit" onclick="openModal('dom_modal_playlist')" style="margin-bottom:10px">+ Lista</button><div id="userPlaylistGrid" class="playlist-grid"></div></div>
      </div>
    </div>

    <div id="view-guest-player" class="view-section">
        <div class="bg-bubble b1"></div><div class="bg-bubble b2"></div><div class="bg-bubble b3"></div>
        <button class="btn-icon" onclick="exitFullScreenPlayer()" style="position:absolute; top:20px; right:20px; z-index:10000; background:rgba(255,255,255,0.1); width:45px; height:45px"><span class="material-icons-round" style="font-size:1.5rem">expand_more</span></button>
        
        <div class="guest-container">
            <div class="logo-text" style="font-size:1.5rem; margin:0; opacity:0.7">Musi<span>Chris</span></div>
            
            <div id="guestCover"></div>
            
            <div class="guest-info-area">
                <h2 id="guestTitle" style="font-size:1.4rem; margin:0 0 5px 0; text-shadow:0 2px 10px rgba(0,0,0,0.3); padding:0 10px;">Cargando...</h2>
                <p id="guestArtist" style="color:rgba(255,255,255,0.7); font-size:1rem; margin:0;">...</p>
                <div class="big-visualizer" id="bigViz" style="height:30px; margin-top:10px">
                    <div class="s-bar"></div><div class="s-bar"></div><div class="s-bar"></div><div class="s-bar"></div><div class="s-bar"></div>
                    <div class="s-bar"></div><div class="s-bar"></div><div class="s-bar"></div><div class="s-bar"></div><div class="s-bar"></div>
                </div>
            </div>
            
            <div class="guest-controls-area">
                <div class="guest-controls-extra">
                    <button class="btn-guest-action" id="guestLikeBtn" onclick="toggleLikeCurrent()"><span class="material-icons-round">favorite_border</span></button>
                    <button class="btn-guest-action" onclick="shareCurrentSong()"><span class="material-icons-round">share</span></button>
                    <button class="btn-guest-action" onclick="openModal('dom_modal_sleep_timer')"><span class="material-icons-round">bedtime</span></button>
                </div>

                <div style="width:100%; max-width:400px; margin-top:15px">
                    <input type="range" id="guestSeekSlider" value="0" max="100" style="width:100%; margin-bottom:20px; height:6px">
                    <div style="display:flex; justify-content:center; gap:30px; align-items:center;">
                        <span class="material-icons-round ctrl-icon" onclick="prev()">skip_previous</span>
                        <button class="btn-icon" onclick="toggle_play()" style="width:70px; height:70px; background:white; color:black; box-shadow:0 0 20px rgba(255,255,255,0.4)">
                            <span class="material-icons-round" id="iconPlay">play_arrow</span>
                        </button>
                        <span class="material-icons-round ctrl-icon" onclick="next()">skip_next</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="dom_modal_upload"><div class="modal-content"><h2>Subir</h2><input type="text" id="upTitle" class="form-input" placeholder="T√≠tulo"><select id="upGenre" class="form-input" style="background:#333;color:white"><option>Alabanza</option><option>Adoraci√≥n</option><option>Pop</option><option>Instrumental</option></select><label style="color:#aaa;font-size:0.8rem">√Ålbum:</label><select id="upAlbum" class="form-input" style="background:#333;color:white"></select><div style="background:rgba(255,255,255,0.05);padding:10px;border-radius:10px;margin-bottom:10px;border:1px dashed #555"><label style="color:var(--accent);display:block;margin-bottom:5px">üìÇ Archivo MP3</label><input type="file" id="upFileMp3" class="form-input" accept="audio/*"><p style="font-size:0.7rem;color:#aaa">O enlace:</p><input type="url" id="upUrl" class="form-input" placeholder="https://..." style="margin-bottom:0"></div><button class="btn-submit" id="btnActionUpload" onclick="do_upload()">Guardar</button><button class="close-modal" onclick="closeModal('dom_modal_upload')">Cancelar</button></div></div>
    <div class="modal-overlay" id="dom_modal_edit_song"><div class="modal-content"><h2>Editar Canci√≥n</h2><input type="hidden" id="editSongId"><label>T√≠tulo:</label><input type="text" id="editSongTitle" class="form-input"><label>G√©nero:</label><select id="editSongGenre" class="form-input" style="background:#333;color:white"><option>Alabanza</option><option>Adoraci√≥n</option><option>Pop</option><option>Instrumental</option></select><label>Mover a √Ålbum:</label><select id="editSongAlbum" class="form-input" style="background:#333;color:white"></select><div style="background:rgba(255,255,255,0.05);padding:10px;border-radius:10px;margin:10px 0;border:1px dashed #555"><label style="color:var(--accent);display:block;margin-bottom:5px">üìÇ Archivo MP3 (Opcional)</label><input type="file" id="editSongFile" class="form-input" accept="audio/*"><p style="font-size:0.7rem;color:#aaa">O enlace:</p><input type="url" id="editSongUrl" class="form-input" placeholder="https://..." style="margin-bottom:0"></div><button class="btn-submit" id="btnActionEditSong" onclick="doSaveEditSong()">Guardar Cambios</button><button class="close-modal" onclick="closeModal('dom_modal_edit_song')">Cancelar</button></div></div>
    <div class="modal-overlay" id="dom_modal_edit_album"><div class="modal-content"><h2>Editar √Ålbum</h2><input type="hidden" id="editAlbId"><input type="text" id="editAlbName" class="form-input" placeholder="T√≠tulo"><input type="text" id="editAlbArtist" class="form-input" placeholder="Artista"><div style="background:rgba(255,255,255,0.05);padding:10px;border-radius:10px;margin:10px 0;border:1px dashed #555"><label style="color:var(--accent);display:block;margin-bottom:5px">üì∏ Portada (Imagen)</label><input type="file" id="editAlbFile" class="form-input" accept="image/*"><p style="font-size:0.7rem;color:#aaa">O enlace directo:</p><input type="url" id="editAlbCover" class="form-input" placeholder="https://..." style="margin-bottom:0"></div><button class="btn-submit" id="btnActionEditAlb" onclick="doSaveEditAlbum()">Guardar</button><button class="close-modal" onclick="closeModal('dom_modal_edit_album')">Cancelar</button></div></div>
    <div class="modal-overlay" id="dom_modal_edit_playlist"><div class="modal-content"><h2>Editar Playlist</h2><input type="hidden" id="editPlId"><label>Nombre:</label><input type="text" id="editPlName" class="form-input"><button class="btn-submit" onclick="doSaveEditPlaylist()">Guardar</button><button class="close-modal" onclick="closeModal('dom_modal_edit_playlist')">Cancelar</button></div></div>
    <div class="modal-overlay" id="dom_modal_sleep_timer"><div class="modal-content" style="max-width:300px; text-align:center"><h2>Temporizador üåô</h2><div style="display:flex; flex-direction:column; gap:10px"><button class="btn-submit" onclick="setSleepTimer(15)" style="background:rgba(255,255,255,0.1);margin:0">15 Minutos</button><button class="btn-submit" onclick="setSleepTimer(30)" style="background:rgba(255,255,255,0.1);margin:0">30 Minutos</button><button class="btn-submit" onclick="setSleepTimer(60)" style="background:rgba(255,255,255,0.1);margin:0">1 Hora</button><button class="btn-submit" onclick="setSleepTimer(0)" style="background:var(--danger);margin:0">Apagar Temporizador</button></div><button class="close-modal" onclick="closeModal('dom_modal_sleep_timer')">Cerrar</button></div></div>
    <div class="modal-overlay" id="dom_modal_eq"><div class="modal-content" style="max-width:300px; text-align:center"><h2>Ecualizador üéõÔ∏è</h2><div style="display:flex; justify-content:space-around; height:150px; align-items:center; margin:20px 0"><div class="eq-band"><input type="range" orient="vertical" min="-10" max="10" value="0" oninput="updateEQ('low', this.value)" style="height:120px; -webkit-appearance: slider-vertical;"><label>Bajos</label></div><div class="eq-band"><input type="range" orient="vertical" min="-10" max="10" value="0" oninput="updateEQ('mid', this.value)" style="height:120px; -webkit-appearance: slider-vertical;"><label>Medios</label></div><div class="eq-band"><input type="range" orient="vertical" min="-10" max="10" value="0" oninput="updateEQ('high', this.value)" style="height:120px; -webkit-appearance: slider-vertical;"><label>Agudos</label></div></div><button class="close-modal" onclick="closeModal('dom_modal_eq')">Cerrar</button></div></div>
    <div class="modal-overlay" id="dom_modal_album"><div class="modal-content"><h2>Nuevo √Ålbum</h2><input type="text" id="newAlbName" class="form-input" placeholder="T√≠tulo del √Ålbum"><input type="text" id="newAlbArtist" class="form-input" placeholder="Artista"><div style="background:rgba(255,255,255,0.05);padding:10px;border-radius:10px;margin:10px 0;border:1px dashed #555"><label style="color:white;display:block;margin-bottom:5px">üì∏ Portada (Imagen)</label><input type="file" id="newAlbCoverFile" class="form-input" accept="image/*"><p style="font-size:0.7rem;color:#aaa">O enlace directo:</p><input type="url" id="newAlbCoverUrl" class="form-input" placeholder="https://..." style="margin-bottom:0"></div><button class="btn-submit" id="btnActionCreateAlbum" onclick="do_create_album()">Crear √Ålbum</button><button class="close-modal" onclick="closeModal('dom_modal_album')">Cancelar</button></div></div>
    <div class="modal-overlay" id="dom_modal_date_filter"><div class="modal-content" style="max-width:300px"><h2>Filtrar Fecha</h2><label>Desde:</label><input type="date" id="filterStart" class="form-input" style="color-scheme:dark"><label>Hasta:</label><input type="date" id="filterEnd" class="form-input" style="color-scheme:dark"><button class="btn-submit" onclick="applyDateFilter()">Aplicar</button><button class="btn-submit" onclick="clearDateFilter()" style="background:transparent;border:1px solid #555;margin-top:5px">Limpiar</button><button class="close-modal" onclick="closeModal('dom_modal_date_filter')">Cerrar</button></div></div>
    <div class="modal-overlay" id="dom_modal_playlist"><div class="modal-content"><h2>Playlist</h2><input type="text" id="newPlName" class="form-input" placeholder="Nombre"><button class="btn-submit" onclick="do_create_playlist()">Crear</button><button class="close-modal" onclick="closeModal('dom_modal_playlist')">Cerrar</button></div></div>
    <div class="modal-overlay" id="dom_modal_user"><div class="modal-content"><h2>Usuario</h2><input type="text" id="newUserName" class="form-input" placeholder="Nombre"><input type="text" id="newUserEmail" class="form-input" placeholder="Email"><select id="newUserRole" class="form-input" style="background:#333;color:white"><option value="user">Usuario</option><option value="admin">Admin</option></select><button class="btn-submit" onclick="do_add_user()">Registrar</button><button class="close-modal" onclick="closeModal('dom_modal_user')">Cerrar</button></div></div>
    <div class="modal-overlay" id="dom_modal_profile"><div class="modal-content"><h2>Perfil</h2><div style="text-align:center;margin-bottom:15px"><img src="" id="profilePreview" style="width:80px;height:80px;border-radius:50%;border:2px solid var(--accent)"><p onclick="changeAvatar()" style="cursor:pointer;color:var(--accent);margin-top:5px">üé≤ Cambiar Avatar</p></div><input type="text" id="profileName" class="form-input"><input type="text" id="profileEmail" class="form-input" readonly style="opacity:0.5"><button class="btn-submit" onclick="do_save_profile()">Guardar</button><button class="close-modal" onclick="closeModal('dom_modal_profile')">Cerrar</button></div></div>
    <div class="modal-overlay" id="dom_modal_settings"><div class="modal-content"><h2>Configuraci√≥n</h2><label>Bin ID</label><input type="text" id="cfgBinId" class="form-input"><label>API Key</label><input type="text" id="cfgApiKey" class="form-input"><button class="btn-submit" onclick="do_save_settings()">Guardar</button><hr style="border:0;border-top:1px solid #444;margin:15px 0"><button class="btn-submit" onclick="reset_app_local()" style="background:var(--danger)">Borrar Local</button><button class="close-modal" onclick="closeModal('dom_modal_settings')">Cerrar</button></div></div>
    <div class="modal-overlay" id="dom_modal_announcement"><div class="modal-content"><h2>Anuncio</h2><input type="text" id="announcementInput" class="form-input"><button class="btn-submit" onclick="do_save_announce()">Publicar</button><button class="close-modal" onclick="closeModal('dom_modal_announcement')">Cerrar</button></div></div>
    <div class="modal-overlay" id="dom_modal_select_pl"><div class="modal-content"><h2>Guardar en...</h2><div id="selectPlList"></div><button class="close-modal" onclick="closeModal('dom_modal_select_pl')">Cerrar</button></div></div>
    <div class="modal-overlay" id="dom_modal_pl_detail"><div class="modal-content"><h2 id="plDetailTitle">Lista</h2><button class="btn-submit" onclick="playCollection()" style="margin-bottom:10px">Reproducir Todo</button><div id="plDetailList"></div><button class="close-modal" onclick="closeModal('dom_modal_pl_detail')">Cerrar</button></div></div>

    <div class="bottom-player" id="mainPlayer">
      <div class="player-info">
          <div class="player-cover" style="width:40px;height:40px;background:#333;border-radius:5px;background-size:cover;background-position:center" id="pCover"></div>
          <div style="margin-left:10px"><h4 id="pTitle" style="margin:0;font-size:0.9rem">Titulo</h4><p id="pArtist" style="margin:0;font-size:0.7rem;color:#aaa">Genero</p></div>
      </div>
      
      <div class="player-center-group">
          <div class="controls-row">
              <span class="material-icons-round ctrl-icon" id="btnShuffle" onclick="toggleShuffle()">shuffle</span>
              <span class="material-icons-round ctrl-icon" onclick="prev()">skip_previous</span>
              <div class="btn-play-circle" onclick="toggle_play()"><span class="material-icons-round" id="iconPlay">play_arrow</span></div>
              <span class="material-icons-round ctrl-icon" onclick="next()">skip_next</span>
              <span class="material-icons-round ctrl-icon" id="btnRepeat" onclick="toggleRepeat()">repeat</span>
          </div>
          <input type="range" id="seekSlider" value="0" max="100" style="width:100%">
      </div>
      
      <div class="player-right-group">
          <span class="material-icons-round" onclick="openFullScreenPlayer()" style="cursor:pointer;color:#aaa" title="Pantalla Completa">open_in_full</span>
          <span class="material-icons-round" id="eqBtn" onclick="openModal('dom_modal_eq')" style="cursor:pointer;color:#aaa" title="Ecualizador">graphic_eq</span>
          <span class="material-icons-round" id="shareBtn" onclick="shareCurrentSong()" style="cursor:pointer;color:#aaa" title="Compartir App">share</span>
          <span class="material-icons-round" id="timerBtn" onclick="openModal('dom_modal_sleep_timer')" style="cursor:pointer;color:#aaa" title="Temporizador">bedtime</span>
          <span class="material-icons-round" id="pLikeBtn" onclick="toggleLikeCurrent()" style="cursor:pointer;color:#aaa">favorite_border</span>
          <span class="material-icons-round" onclick="toggleMinimize()">remove</span>
          <span class="material-icons-round" onclick="closePlayer()">close</span>
      </div>
      
      <div class="minimized-player-controls">
          <span class="material-icons-round" onclick="openFullScreenPlayer()" style="cursor:pointer" title="Maximizar">expand_less</span>
          <span class="material-icons-round" onclick="toggle_play()" id="iconPlayMin">play_arrow</span>
          <span class="material-icons-round" onclick="closePlayer()">close</span>
      </div>
    </div>
    <script src="./script.js?v=48"></script>
</body>
</html>
























