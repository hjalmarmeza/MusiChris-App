<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MusiChris App</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="./style.css">
</head>
<body>

    <div class="bg-bubble b1"></div>
    <div class="bg-bubble b2"></div>

    <div id="view-login">
        <div class="login-card">
            <div class="logo-text">Musi<span>Chris</span> üéµ</div>
            <p style="color:#aaa; margin-bottom:20px">Bienvenido</p>
            <input type="email" id="loginEmail" class="login-input" placeholder="Usuario o Email">
            <div class="password-wrapper">
                <input type="password" id="loginPass" class="login-input" placeholder="Contrase√±a">
                <span class="material-icons-round pass-toggle" id="btnTogglePass">visibility_off</span>
            </div>
            <button id="btnLoginBtn" class="btn-login" onclick="handleLoginAttempt()">Ingresar</button>
        </div>
    </div>

    <div id="view-admin" class="view-section">
        <div class="container">
            <header>
                <div class="brand">MusiChris <span>Admin</span></div>
                <div class="header-right">
                    <button class="btn-icon" onclick="openModal('dom_modal_announcement')"><span class="material-icons-round">campaign</span></button>
                    <button class="btn-icon" onclick="openModal('dom_modal_settings')"><span class="material-icons-round">settings</span></button>
                    <div class="user-profile" onclick="openProfile()">
                        <img id="adminAvatar" src="" class="avatar">
                        <span id="adminNameDisplay">Admin</span>
                    </div>
                    <button class="btn-icon btn-logout" onclick="app_logout()"><span class="material-icons-round">logout</span></button>
                </div>
            </header>

            <div class="stats-grid">
                <div class="card">
                    <div style="display:flex; justify-content:space-between; width:100%; align-items:center;">
                        <h3 style="margin:0">Canciones</h3>
                        <span class="material-icons-round" onclick="openModal('dom_modal_date_filter')" style="cursor:pointer; color:var(--accent); font-size:1.2rem;">calendar_today</span>
                    </div>
                    <span class="material-icons-round" style="color:#e67e22; margin:5px 0;">library_music</span>
                    <div class="value" id="statsTotalSongs">0</div>
                </div>
                <div class="card">
                    <h3>Usuarios</h3>
                    <span class="value" id="statsTotalUsers">0</span>
                </div>
                <div class="card">
                    <h3>Nube (25GB)</h3>
                    <div class="value" id="statsCloud">0%</div>
                </div>
            </div>

            <div class="tabs">
                <button class="tab-btn active" onclick="switchTab('admin-music', this)">M√∫sica</button>
                <button class="tab-btn" onclick="switchTab('admin-playlists', this)">Playlist</button>
                <button class="tab-btn" onclick="switchTab('admin-albums', this)">√Ålbum</button>
                <button class="tab-btn" onclick="switchTab('admin-users', this)">Usuarios</button>
            </div>

            <div id="admin-music" class="list-tab-content active">
                <div class="btn-dashed-style" onclick="openUpload()">+ Subir Canci√≥n</div>
                <div style="background:#252535; padding:10px; border-radius:12px; margin-bottom:15px; display:flex; align-items:center;">
                    <span class="material-icons-round" style="color:#aaa; margin-right:10px;">search</span>
                    <input type="text" id="searchInputAdmin" placeholder="Buscar canci√≥n..." style="background:transparent; border:none; color:white; width:100%; outline:none;">
                </div>
                <div id="adminSongList"></div>
            </div>

            <div id="admin-playlists" class="list-tab-content">
                <div class="btn-dashed-style" onclick="doCreatePlaylist()">+ Nueva Playlist</div>
                <div id="adminPlaylistGrid" class="playlist-grid"></div>
            </div>

            <div id="admin-albums" class="list-tab-content">
                <div class="btn-dashed-style" onclick="openModal('dom_modal_album')">+ Nuevo √Ålbum</div>
                <div id="adminAlbumGrid" class="playlist-grid"></div>
            </div>

            <div id="admin-users" class="list-tab-content">
                <div class="btn-dashed-style" onclick="openModal('dom_modal_new_user')">+ Nuevo Usuario</div>
                <div id="usersListGrid"></div>
            </div>
        </div>
    </div>

    <div id="view-user" class="view-section">
        <div class="container">
            <header>
                <div class="brand">Musi<span>Chris</span></div>
                <div class="header-right">
                    <div class="user-profile" onclick="openProfile()">
                        <img id="userAvatarImg" src="" class="avatar">
                        <span id="userGreeting">Hola</span>
                    </div>
                    <button class="btn-icon" onclick="app_logout()"><span class="material-icons-round">logout</span></button>
                </div>
            </header>

            <div id="userAnnouncement" class="btn-dashed-style announcement-box" style="display:none;">
                <h3 style="color:var(--accent);">üì¢ Noticias</h3>
                <p id="announcementText"></p>
            </div>

            <div class="tabs">
                <button class="tab-btn active" onclick="switchTab('user-music', this)">M√∫sica</button>
                <button class="tab-btn" onclick="switchTab('user-playlists', this)">Playlist</button>
                <button class="tab-btn" onclick="switchTab('user-albums', this)">√Ålbum</button>
            </div>

            <div id="user-music" class="list-tab-content active">
                <div style="background:#252535; padding:10px; border-radius:12px; margin-bottom:15px; display:flex; align-items:center;">
                    <span class="material-icons-round" style="color:#aaa; margin-right:10px;">search</span>
                    <input type="text" id="searchInputUser" placeholder="Buscar canci√≥n..." style="background:transparent; border:none; color:white; width:100%; outline:none;">
                </div>
                <div id="userSongList"></div>
            </div>

            <div id="user-playlists" class="list-tab-content">
                <div id="userPlaylistGrid" class="playlist-grid"></div>
            </div>

            <div id="user-albums" class="list-tab-content">
                <div id="userAlbumGrid" class="playlist-grid"></div>
            </div>
        </div>
    </div>

    <div id="mainPlayer" class="bottom-player" onclick="openFullScreenPlayer()">
        <div class="player-info">
            <img id="pCoverMini" src="" style="width:45px; height:45px; border-radius:8px; object-fit:cover; background:#333;">
            <div style="overflow:hidden;">
                <h4 id="pTitle" style="margin:0; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">T√≠tulo</h4>
                <p id="pArtist" style="margin:0; color:#aaa; font-size:0.8rem;">Artista</p>
            </div>
        </div>
        
        <div class="player-center-group">
            <div class="controls-row">
                <span class="material-icons-round ctrl-icon small-icon" onclick="event.stopPropagation(); toggleShuffle()">shuffle</span>
                <span class="material-icons-round ctrl-icon" onclick="event.stopPropagation(); prev()">skip_previous</span>
                <div class="btn-play-circle" onclick="event.stopPropagation(); toggle_play()">
                    <span id="iconPlay" class="material-icons-round">play_arrow</span>
                </div>
                <span class="material-icons-round ctrl-icon" onclick="event.stopPropagation(); next()">skip_next</span>
                <span class="material-icons-round ctrl-icon small-icon" onclick="event.stopPropagation(); toggleRepeat()">repeat</span>
            </div>
            <input type="range" id="seekSlider" value="0" min="0" max="100" onclick="event.stopPropagation()">
        </div>
        
        <div class="player-right-group">
            <span class="material-icons-round" id="pLikeBtn" onclick="event.stopPropagation(); toggleLikeCurrent()">favorite_border</span>
            <span class="material-icons-round" onclick="event.stopPropagation(); openModal('dom_modal_eq')">graphic_eq</span>
            <span class="material-icons-round" onclick="event.stopPropagation(); openFullScreenPlayer()" style="font-size:1.5rem">open_in_full</span>
            <span class="material-icons-round" onclick="event.stopPropagation(); closePlayer()">close</span>
        </div>

        <div class="minimized-player-controls">
            <span class="material-icons-round" onclick="openFullScreenPlayer()" style="font-size:2rem; margin-right:10px;">expand_less</span>
            <span id="iconPlayMin" class="material-icons-round" onclick="event.stopPropagation(); toggle_play()">play_arrow</span>
            <span class="material-icons-round" onclick="event.stopPropagation(); closePlayer()" style="color:var(--danger)">close</span>
        </div>
    </div>

    <div id="view-guest-player">
        <div style="display:flex; justify-content:space-between; width:100%; padding:10px;">
            <span class="material-icons-round btn-guest-action" onclick="closePlayer()">keyboard_arrow_down</span>
            <span style="color:#aaa; font-size:0.9rem; letter-spacing:1px;">REPRODUCIENDO</span>
            <span class="material-icons-round btn-guest-action" onclick="openModal('dom_modal_eq')">graphic_eq</span>
        </div>

        <div class="guest-container">
            <div id="guestCover"></div>
            <div class="guest-info-area">
                <h2 id="guestTitle">T√≠tulo</h2>
                <p id="guestArtist">Artista</p>
                </div>
            <div class="guest-controls-extra">
                <span class="material-icons-round btn-guest-action" onclick="shareCurrentSong()">share</span>
                <div id="guestLikeBtn" onclick="toggleLikeCurrent()">
                    <span class="material-icons-round btn-guest-action">favorite_border</span>
                </div>
                <span class="material-icons-round btn-guest-action">bedtime</span> 
            </div>
            <div class="guest-controls-main">
                </div>
        </div>
    </div>

    <div id="dom_modal_upload" class="modal-overlay">
        <div class="modal-content">
            <button class="close-btn-x" onclick="closeModal('dom_modal_upload')">√ó</button>
            <h3 id="modalUploadTitle" style="margin-top:0">Subir Canci√≥n</h3>
            <input type="text" id="upTitle" class="form-input" placeholder="T√≠tulo">
            <input type="text" id="upGenre" class="form-input" placeholder="Artista / G√©nero">
            <select id="upAlbum" class="form-input" style="background:#1a1a2e;color:#aaa"><option value="">Sin √Ålbum</option></select>
            <input type="text" id="upUrl" class="form-input" placeholder="Enlace MP3 (http://...)">
            <div class="modal-footer" style="display:flex; gap:10px; margin-top:20px;">
                 <button class="close-modal" onclick="closeModal('dom_modal_upload')" style="flex:1; border:1px solid #666; color:#ddd; padding:12px; border-radius:8px;">Cancelar</button>
                 <button id="btnUploadSubmit" class="btn-submit" style="flex:2; margin:0;" onclick="do_upload()">Subir</button>
            </div>
        </div>
    </div>

    <div id="dom_modal_album" class="modal-overlay"><div class="modal-content"><button class="close-btn-x" onclick="closeModal('dom_modal_album')">√ó</button><h3>Nuevo √Ålbum</h3><input type="text" id="newAlbName" class="form-input" placeholder="Nombre del √Ålbum"><input type="text" id="newAlbArtist" class="form-input" placeholder="Artista Principal"><div style="margin:10px 0; border:1px dashed #555; padding:10px; border-radius:10px;"><label for="newAlbCoverFile" style="color:var(--accent); cursor:pointer;">üìÇ Elegir Portada (Dispositivo)</label><input type="file" id="newAlbCoverFile" accept="image/*" style="display:none;" onchange="previewFile(this, 'newAlbCoverUrl')"></div><input type="text" id="newAlbCoverUrl" class="form-input" placeholder="O pegar enlace..."><button class="btn-submit" onclick="do_create_album()">Crear</button></div></div>
    <div id="dom_modal_new_user" class="modal-overlay"><div class="modal-content"><button class="close-btn-x" onclick="closeModal('dom_modal_new_user')">√ó</button><h3>Registrar Usuario</h3><input type="text" id="newUser_Name" class="form-input" placeholder="Nombre"><input type="email" id="newUser_Email" class="form-input" placeholder="Email"><input type="password" id="newUser_Pass" class="form-input" placeholder="Contrase√±a"><div style="display:flex; gap:10px; margin-top:20px;"><button class="close-modal" onclick="closeModal('dom_modal_new_user')" style="flex:1; border:1px solid #666; color:#ddd;">Cancelar</button><button class="btn-submit" style="flex:2; margin:0;" onclick="do_create_user_modal()">Registrar</button></div></div></div>
    <div id="dom_modal_pl_detail" class="modal-overlay"><div class="modal-content"><button class="close-btn-x" onclick="closeModal('dom_modal_pl_detail')">√ó</button><div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:15px;"><h3 id="plDetailTitle" style="margin:0">Lista</h3><button class="btn-submit" style="margin:0; width:auto; padding:8px 15px;" onclick="playCollection()">Reproducir Todo</button></div><div id="plDetailList"></div></div></div>
    <div id="dom_modal_profile" class="modal-overlay"><div class="modal-content"><button class="close-btn-x" onclick="closeModal('dom_modal_profile')">√ó</button><h3>Mi Perfil</h3><div style="text-align:center;margin-bottom:15px;"><img id="profilePreview" src="" style="width:80px;height:80px;border-radius:50%;object-fit:cover;border:2px solid var(--accent);"><br><button style="background:transparent;border:1px solid #555;color:#ccc;padding:5px 10px;border-radius:15px;margin-top:10px;cursor:pointer;" onclick="changeAvatar()">Cambiar Avatar</button></div><input type="text" id="profileName" class="form-input"><input type="email" id="profileEmail" class="form-input" disabled style="opacity:0.5"><button class="btn-submit" onclick="do_save_profile()">Guardar Cambios</button></div></div>
    <div id="dom_modal_announcement" class="modal-overlay"><div class="modal-content"><button class="close-btn-x" onclick="closeModal('dom_modal_announcement')">√ó</button><h3>Publicar Noticia</h3><textarea id="announcementInput" class="form-input" rows="4" placeholder="Mensaje..."></textarea><button class="btn-submit" onclick="do_save_announce()">Publicar</button></div></div>
    <div id="dom_modal_settings" class="modal-overlay"><div class="modal-content"><button class="close-btn-x" onclick="closeModal('dom_modal_settings')">√ó</button><h3>Configuraci√≥n</h3><input type="text" id="cfgBinId" class="form-input" disabled><input type="password" id="cfgApiKey" class="form-input" disabled><button class="btn-submit" onclick="closeModal('dom_modal_settings')">Cerrar</button></div></div>
    <div id="dom_modal_edit_album" class="modal-overlay"><div class="modal-content"><button class="close-btn-x" onclick="closeModal('dom_modal_edit_album')">√ó</button><h3>Editar √Ålbum</h3><input type="text" id="editAlbName" class="form-input"><input type="text" id="editAlbArtist" class="form-input"><div style="margin:10px 0; border:1px dashed #555; padding:10px; border-radius:10px;"><label for="editAlbCoverFile" style="color:var(--accent); cursor:pointer;">üìÇ Cambiar Portada</label><input type="file" id="editAlbCoverFile" accept="image/*" style="display:none;" onchange="previewFile(this, 'editAlbCover')"></div><input type="text" id="editAlbCover" class="form-input"><button class="btn-submit" onclick="doSaveEditAlbum()">Guardar</button></div></div>
    <div id="dom_modal_date_filter" class="modal-overlay"><div class="modal-content" style="max-width:300px"><h2>Filtrar Fecha</h2><label>Desde:</label><input type="date" id="filterStart" class="form-input" style="color-scheme:dark"><label>Hasta:</label><input type="date" id="filterEnd" class="form-input" style="color-scheme:dark"><button class="btn-submit" onclick="applyDateFilter()">Aplicar</button><button class="btn-submit" onclick="clearDateFilter()" style="background:transparent;border:1px solid #555;margin-top:5px">Limpiar</button><button class="close-modal" onclick="closeModal('dom_modal_date_filter')">Cerrar</button></div></div>
    <div id="dom_modal_eq" class="modal-overlay"><div class="modal-content" style="max-width:320px; text-align:center"><button class="close-btn-x" onclick="closeModal('dom_modal_eq')">√ó</button><h3>Ecualizador üéõÔ∏è</h3><div style="display:flex; justify-content:space-around; height:150px; align-items:center; margin:20px 0"><div class="eq-band"><input type="range" orient="vertical" min="-10" max="10" value="0" class="eq-slider"><label>Bajos</label></div><div class="eq-band"><input type="range" orient="vertical" min="-10" max="10" value="0" class="eq-slider"><label>Medios</label></div><div class="eq-band"><input type="range" orient="vertical" min="-10" max="10" value="0" class="eq-slider"><label>Agudos</label></div></div></div></div>

    <div id="customToast" class="customToast">Mensaje</div>
    
    <script src="./script.js?v=71"></script>
</body>
</html>









